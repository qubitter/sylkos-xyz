  on:
    workflow_dispatch:
    push:
      branches:
        - "main"
  
  permissions:
    contents: read
    pages: write
    id-token: write
  
  jobs:
    deploy:
      environment:
        name: github-pages
        url: ${{ steps.deployment.outputs.page_url }}
      runs-on: ubuntu-latest
      steps:
      - name: Checkout
        uses: actions/checkout@v4
        
      - name: Setup Rust Toolchain
        uses: actions-rs/toolchain@v1
        with:
          toolchain: stable
          target: wasm32-unknown-unknown
    
      - name: Fix WASM :(
        run: cargo update -p wasm-bindgen --precise 0.2.92
          
      - name: Rust Cache
        uses: Swatinem/rust-cache@v2.2.1
        with:
          cache-on-failure: true
        
      - name: Setup Dioxus Cli
        run: cargo install dioxus-cli
        
      - name: Setup TailwindCSS Cli
        run: npm -g install tailwindcss

      - name: Install Catppuccin Node Module
        run: npm install -D @catppuccin/tailwindcss
        
      - name: Run TailwindCSS Compiler
        run: npx tailwind -c tailwind.config.js -o src/index.css --minify

      - name: Run Dioxus
        run: dx build --release
        
      - name: Setup Pages
        uses: actions/configure-pages@v5

      - name: Upload
        uses: actions/upload-pages-artifact@v3
        with: 
          path: dist
  
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
  